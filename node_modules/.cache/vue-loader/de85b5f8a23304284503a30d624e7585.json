{"remainingRequest":"/Users/admin/Desktop/turn_table/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/Users/admin/Desktop/turn_table/src/views/prize.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/admin/Desktop/turn_table/src/views/prize.vue","mtime":1636105588265},{"path":"/Users/admin/Desktop/turn_table/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/turn_table/node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/admin/Desktop/turn_table/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/admin/Desktop/turn_table/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZGF5anMgZnJvbSAiZGF5anMiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBhY3RpdmVUYWI6ICJlZmZlY3RpdmUiLA0KICAgICAgbGlzdDogW10sDQogICAgICBjYXRlZ29yeTogWw0KICAgICAgICB7IGtleTogImVmZmVjdGl2ZSIsIHRpdGxlOiAi5pyJ5pWIIiwgbGlzdDogW10gfSwNCiAgICAgICAgeyBrZXk6ICJpbnZhbGlkIiwgdGl0bGU6ICLlpLHmlYgiLCBsaXN0OiBbXSB9LA0KICAgICAgXSwNCiAgICB9Ow0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuZ2V0UHJpemVMaXN0KCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBnZXRQcml6ZUxpc3QoKSB7DQogICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy4kYXBpLmdldFByaXplTGlzdCh0aGlzLiRyb3V0ZS5xdWVyeSk7DQogICAgICBsZXQgZWZmZWN0aXZlID0gcmVzLmRhdGEuZmlsdGVyKCh2KSA9PiB0aGlzLmNoZWNrRWZmZWN0aXZlKHYpKTsNCiAgICAgIGxldCBpbnZhbGlkID0gcmVzLmRhdGEuZmlsdGVyKCh2KSA9PiAhdGhpcy5jaGVja0VmZmVjdGl2ZSh2KSk7DQogICAgICB0aGlzLmNhdGVnb3J5WzBdLmxpc3QgPSBlZmZlY3RpdmU7DQogICAgICB0aGlzLmNhdGVnb3J5WzFdLmxpc3QgPSBpbnZhbGlkOw0KICAgICAgY29uc29sZS5sb2cocmVzLCAi5Lit5aWW6K6w5b2VIik7DQogICAgfSwNCiAgICBhc3luYyB1c2UoaXRlbSkgew0KICAgICAgdGhpcy4kZGlhbG9nDQogICAgICAgIC5jb25maXJtKHsNCiAgICAgICAgICBtZXNzYWdlOiAi56Gu6K6k5L2/55So5q2k5LyY5oOg5Yi477yfIiwNCiAgICAgICAgICB3aWR0aDogIjI4MCIsDQogICAgICAgIH0pDQogICAgICAgIC50aGVuKGFzeW5jIChtc2cpID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtLCAiaXRlbSIpOw0KICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRhcGkuY2hhbmdlQ291cG9uU3RhdHVzKHsNCiAgICAgICAgICAgIGNvdXBvbmlkOiBpdGVtLmlkLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKCkgPT4ge30pOw0KICAgIH0sDQogICAgLy8g5pyq5L2/55SoIOacqui/h+acnyA9IOacieaViO+8jOWFtuS9memDveWxnuS6juWkseaViA0KICAgIC8vIGV4cGlyZWRfdGltZTogIjIwMjEtMTAtMjgiIOWkseaViOaXtumXtA0KICAgIC8vIHN0YXR1czogMSDmmK/lkKbkvb/nlKggIDEg5L2/55SoICAw5pyq5L2/55SoDQogICAgY2hlY2tFZmZlY3RpdmUoaXRlbSkgew0KICAgICAgbGV0IHRpbWUgPQ0KICAgICAgICBkYXlqcyhpdGVtLmV4cGlyZWRfdGltZSkudmFsdWVPZigpICsgMjQgKiA2MCAqIDYwICogMTAwMCAtIDEwMDA7DQogICAgICB0aW1lID0gZGF5anModGltZSkuZm9ybWF0KCJZWVlZLU1NLUREIEhIOm1tOnNzIik7DQogICAgICByZXR1cm4gZGF5anMoKS5pc0JlZm9yZSh0aW1lKSAmJiAhaXRlbS5zdGF0dXMgPyB0cnVlIDogZmFsc2U7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["prize.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"prize.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"prize\">\r\n    <van-tabs v-model=\"activeTab\" swipeable animated>\r\n      <van-tab v-for=\"(cate, i) in category\" :key=\"i\" :title=\"cate.title\">\r\n        <div v-for=\"(item, index) in cate.list\" :key=\"index\" class=\"list-item\">\r\n          <div class=\"left\">\r\n            <div class=\"left-img\">\r\n              <img\r\n                src=\"../assets/image/prize.png\"\r\n                alt=\"\"\r\n                style=\"width：100%;height:100%;\"\r\n              />\r\n            </div>\r\n            <div class=\"left-rows\">\r\n              <div class=\"row-tip\">限活动页使用</div>\r\n              <!-- <div class=\"row-date\">\r\n            <span>有效日期：</span>\r\n            <span>2020-10-11</span>\r\n          </div> -->\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"right\"\r\n            :class=\"checkEffective(item) ? 'effective' : 'invalid'\"\r\n            @click=\"checkEffective(item) ? use(item) : '' \"\r\n          >\r\n            <div class=\"price\">\r\n              <span class=\"icon\">￥</span>\r\n              <span class=\"number\">{{ item.lotteryinfo }}</span>\r\n            </div>\r\n            <div class=\"text\">\r\n              {{ checkEffective(item) ? \"点击使用\" : \"已失效\" }}\r\n            </div>\r\n            <div></div>\r\n          </div>\r\n          <!-- 半圆 -->\r\n          <div class=\"circle-bottom\"></div>\r\n          <div class=\"circle-top\"></div>\r\n        </div>\r\n      </van-tab>\r\n    </van-tabs>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport dayjs from \"dayjs\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      activeTab: \"effective\",\r\n      list: [],\r\n      category: [\r\n        { key: \"effective\", title: \"有效\", list: [] },\r\n        { key: \"invalid\", title: \"失效\", list: [] },\r\n      ],\r\n    };\r\n  },\r\n  mounted() {\r\n    this.getPrizeList();\r\n  },\r\n  methods: {\r\n    async getPrizeList() {\r\n      let res = await this.$api.getPrizeList(this.$route.query);\r\n      let effective = res.data.filter((v) => this.checkEffective(v));\r\n      let invalid = res.data.filter((v) => !this.checkEffective(v));\r\n      this.category[0].list = effective;\r\n      this.category[1].list = invalid;\r\n      console.log(res, \"中奖记录\");\r\n    },\r\n    async use(item) {\r\n      this.$dialog\r\n        .confirm({\r\n          message: \"确认使用此优惠券？\",\r\n          width: \"280\",\r\n        })\r\n        .then(async (msg) => {\r\n          console.log(item, \"item\");\r\n          let res = await this.$api.changeCouponStatus({\r\n            couponid: item.id,\r\n          });\r\n        })\r\n        .catch(() => {});\r\n    },\r\n    // 未使用 未过期 = 有效，其余都属于失效\r\n    // expired_time: \"2021-10-28\" 失效时间\r\n    // status: 1 是否使用  1 使用  0未使用\r\n    checkEffective(item) {\r\n      let time =\r\n        dayjs(item.expired_time).valueOf() + 24 * 60 * 60 * 1000 - 1000;\r\n      time = dayjs(time).format(\"YYYY-MM-DD HH:mm:ss\");\r\n      return dayjs().isBefore(time) && !item.status ? true : false;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.prize {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding: 0px 40px;\r\n  box-sizing: border-box;\r\n  background-color: #f7f7f7;\r\n}\r\n/deep/ .van-tabs__wrap {\r\n  width: 100%;\r\n  height: 6vh;\r\n  .van-tab {\r\n    font-size: 28px;\r\n    background-color: #f7f7f7;\r\n    .van-tab__text {\r\n      height: 40px;\r\n      font-weight: bold;\r\n      line-height: 40px;\r\n    }\r\n  }\r\n}\r\n/deep/ .van-tabs__content {\r\n  .van-tab__pane {\r\n    height: 94vh;\r\n    padding: 20px 0;\r\n    box-sizing: border-box;\r\n    overflow-y: scroll;\r\n  }\r\n}\r\n.list-item {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  width: 100%;\r\n  height: 176px;\r\n  margin-bottom: 30px;\r\n  border-radius: 10px;\r\n  box-shadow: 0px 4px 14px 0px rgba(129, 126, 122, 0.21);\r\n  .left {\r\n    display: flex;\r\n    align-items: center;\r\n    width: 472px;\r\n    height: 100%;\r\n    background-color: #f7f2ec;\r\n    border-top-left-radius: 10px;\r\n    border-bottom-left-radius: 10px;\r\n    .left-img {\r\n      width: 120px;\r\n      height: 120px;\r\n      margin-left: 34px;\r\n    }\r\n    .left-rows {\r\n      height: 130px;\r\n      color: #d49f6f;\r\n      font-weight: bold;\r\n      padding: 18px 0 0 34px;\r\n      box-sizing: border-box;\r\n      .row-tip {\r\n        font-size: 28px;\r\n        margin-bottom: 24px;\r\n      }\r\n      .row-date {\r\n        font-size: 24px;\r\n      }\r\n    }\r\n  }\r\n  .circle-top {\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 457px;\r\n    width: 30px;\r\n    height: 15px;\r\n    border-radius: 0px 0px 15px 15px;\r\n    background-color: #f7f7f7;\r\n    box-shadow: inset 0px 0px 10px 4px rgba(226, 224, 222, 0.21);\r\n  }\r\n  .circle-bottom {\r\n    position: absolute;\r\n    bottom: 0px;\r\n    left: 457px;\r\n    width: 30px;\r\n    height: 15px;\r\n    border-radius: 15px 15px 0px 0px;\r\n    background-color: #f7f7f7;\r\n    box-shadow: inset 0px 0px 10px 4px rgba(226, 224, 222, 0.21);\r\n  }\r\n  .right {\r\n    flex-grow: 1;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    height: 100%;\r\n\r\n    font-weight: bold;\r\n    text-shadow: 0px 2px 4px rgba(163, 111, 46, 0.49);\r\n    padding: 46px 0 46px 0;\r\n    box-sizing: border-box;\r\n\r\n    border-top-right-radius: 10px;\r\n    border-bottom-right-radius: 10px;\r\n    .price {\r\n      margin-bottom: 20px;\r\n      .icon {\r\n        font-size: 24px;\r\n      }\r\n      .number {\r\n        font-size: 34px;\r\n      }\r\n    }\r\n    .text {\r\n      font-size: 24px;\r\n    }\r\n  }\r\n}\r\n.effective {\r\n  color: #fff !important;\r\n  background: linear-gradient(to bottom, #f1d187, #eab464) !important;\r\n}\r\n.invalid {\r\n  color: #939393 !important;\r\n  background-color: #e0e0e0 !important;\r\n}\r\n</style>\n"]}]}